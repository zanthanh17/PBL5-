server:
  base_url: "http://192.168.110.63:8001"
  timeout_sec: 3

device:
  id: "pi-entrance-01"

camera:
  width: 640  # Tối ưu tối đa cho Pi 3B+ (giảm CPU ~50%)
  height: 480

ui:
  window_name: "Face Client (Pi3B+)"
  show_fps: true

recognition:
  mode: "real"   # hoặc "fixed_test" để thử
  model_path: "/home/pi/face-client/models/mobilefacenet.tflite"
  tta_flip: false  # Tắt TTA để tăng tốc (có thể bật nếu cần accuracy cao hơn)
  quality_min: 0.45  # Giảm để accept nhiều ảnh hơn
  enhance_low_quality: false  # TẮT để tránh lag (chỉ bật nếu ánh sáng RẤT kém)
  frame_skip: 3  # Base frame skip (sẽ tự động điều chỉnh nếu adaptive_skip enabled)
  throttle_recognition: 0.8  # Giảm delay giữa các lần recognize (chỉ dùng khi async_recognition=false)
  multi_frame_voting: true  # Bật voting để tăng accuracy
  vote_window: 5  # Số frames để vote
  vote_threshold: 3  # Số votes tối thiểu để accept
  
  # PHASE 1 OPTIMIZATIONS
  async_recognition: true  # Bật async recognition worker (tăng FPS 20-30%)
  adaptive_frame_skip: true  # Tự động điều chỉnh frame skip theo CPU load
  max_frame_skip: 5  # Frame skip tối đa khi CPU cao
  min_frame_skip: 1  # Frame skip tối thiểu khi CPU thấp
  cpu_check_interval: 2.0  # Kiểm tra CPU mỗi N giây
  
  # PHASE 2 OPTIMIZATIONS
  roi_tracking: true  # Bật ROI tracking (giảm 60-70% face detection time)
  roi_decay: 0.9  # Confidence decay rate khi không detect được face
  roi_min_confidence: 0.3  # Confidence tối thiểu để dùng ROI
  roi_expand: 1.5  # Hệ số mở rộng ROI (1.5 = 150% kích thước face)
  show_roi: false  # Hiển thị ROI rectangle để debug
  network_compression: true  # Bật network compression (giảm 60-70% bandwidth)
  
  # SENSOR INTEGRATION
  max_retries: 3  # Số lần thử lại khi nhận diện thất bại
  recognition_timeout: 15.0  # Timeout nhận diện (giây)
  cooldown_after_success: 5.0  # Cooldown sau khi nhận diện thành công (giây) - không detect/nhận diện trong thời gian này

tts:
  enabled: true   # Bật/tắt Text-to-Speech
  volume: 100     # Âm lượng (0-200)
  speed: 150      # Tốc độ nói (80-450 words per minute)
  cooldown: 3.0   # Thời gian chờ giữa 2 lần phát cùng message (giây)

sensor:
  enabled: true   # Bật/tắt HC-SR04 + LED (chỉ bật khi đã đấu nối phần cứng)
  trig_pin: 23    # GPIO pin cho HC-SR04 TRIG (BCM)
  echo_pin: 24    # GPIO pin cho HC-SR04 ECHO (BCM)
  led_pin: 18     # GPIO pin cho MOSFET Gate (BCM)
  trigger_distance: 50.0    # Khoảng cách ngưỡng (cm) - LED ON khi < ngưỡng
  led_on_duration: 15.0     # Thời gian tối đa giữ LED sáng (giây) - sẽ tắt sớm hơn nếu nhận diện thành công
  check_interval: 0.2       # Thời gian giữa các lần đo (giây) - 0.2s = real-time
  turn_off_on_success: true  # Tắt LED ngay khi nhận diện thành công

jobs:
  poll_min_sec: 1
  poll_max_sec: 15
  enroll_timeout_sec: 30

